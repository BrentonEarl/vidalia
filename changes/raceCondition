  Internal cleanups and improvements:
  o Make sure there is a ReceiveWaiter in the queue before issuing a
    ControlCommand to avoid deadlocks in the event loop.